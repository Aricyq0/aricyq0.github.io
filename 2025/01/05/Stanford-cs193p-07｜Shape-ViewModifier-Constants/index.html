<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"aricyq0.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="本文是斯坦福大学 cs193p 公开课程第 07 集的相关笔记。">
<meta property="og:type" content="article">
<meta property="og:title" content="Stanford cs193p 07｜Shape ViewModifier Constants">
<meta property="og:url" content="https://aricyq0.github.io/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/index.html">
<meta property="og:site_name" content="Serein">
<meta property="og:description" content="本文是斯坦福大学 cs193p 公开课程第 07 集的相关笔记。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://aricyq0.github.io/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/cs193p|07|1.png">
<meta property="og:image" content="https://aricyq0.github.io/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/cs193p%7C07%7C2.png">
<meta property="og:image" content="https://aricyq0.github.io/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/cs193p%7C07%7C3.png">
<meta property="article:published_time" content="2025-01-05T13:44:22.000Z">
<meta property="article:modified_time" content="2025-01-05T14:33:07.343Z">
<meta property="article:author" content="Serein">
<meta property="article:tag" content="cs193p">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://aricyq0.github.io/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/cs193p|07|1.png">

<link rel="canonical" href="https://aricyq0.github.io/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Stanford cs193p 07｜Shape ViewModifier Constants | Serein</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Serein</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/aricyq0" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aricyq0.github.io/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.JPEG">
      <meta itemprop="name" content="Serein">
      <meta itemprop="description" content="Crazy learning, crazy sharing.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Serein">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Stanford cs193p 07｜Shape ViewModifier Constants
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-01-05 21:44:22 / 修改时间：22:33:07" itemprop="dateCreated datePublished" datetime="2025-01-05T21:44:22+08:00">2025-01-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index"><span itemprop="name">code</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/swift/" itemprop="url" rel="index"><span itemprop="name">swift</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="far fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>15k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>13 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>本文是斯坦福大学 cs193p 公开课程第 07 集的相关笔记。</p>
<span id="more"></span>

<p>cs193p 课程介绍:</p>
<blockquote>
<p>The lectures for the Spring 2023 version of Stanford University’s course CS193p (Developing Applications for iOS using SwiftUI) were given in person but, unfortunately, were not video recorded. However, we did capture the laptop screen of the presentations and demos as well as the associated audio. You can watch these screen captures using the links below. You’ll also find links to supporting material that was distributed to students during the quarter (homework, demo code, etc.).</p>
</blockquote>
<p>cs193p 课程网址: <a target="_blank" rel="noopener" href="https://cs193p.sites.stanford.edu/2023">https://cs193p.sites.stanford.edu/2023</a>–</p>
<h2 id="0-引言"><a href="#0-引言" class="headerlink" title="0. 引言"></a>0. <strong>引言</strong></h2><p>本节概述了与 SwiftUI 和 Swift 编程相关的关键概念和主题。讨论的主题包括：</p>
<p><strong>代码演示插曲</strong></p>
<ul>
<li>将视图分离到各自的文件中。</li>
<li>理解 Swift 中的常量。</li>
</ul>
<p><strong>形状(Shape)</strong></p>
<ul>
<li>绘制自定义形状。</li>
<li>Demo：在卡片中绘制一个“饼状”的倒计时（未添加动画）。</li>
</ul>
<p><strong>动画(Animation)</strong></p>
<ul>
<li>如何工作的</li>
</ul>
<p><strong>视图调整器(ViewModifier)</strong></p>
<ul>
<li>视图调整器的工作机制</li>
</ul>
<h2 id="2-演示插曲"><a href="#2-演示插曲" class="headerlink" title="2. 演示插曲"></a>2. <strong>演示插曲</strong></h2><h3 id="2-1-分离视图"><a href="#2-1-分离视图" class="headerlink" title="2.1 分离视图"></a>2.1 分离视图</h3><p>新建一个 <code>swiftUI</code> 文件，命名为 <code>CardView</code>。我们将 <code>EmojiMemoryGameView</code> 中的 <code>CardView</code> 视图分离出来放在单独的 <code>CardView.swift</code> 文件中，以实现模块化。为了便于检查代码，设置卡片的预览视图。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CardView.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> card: <span class="type">MemoryGame</span>&lt;<span class="type">String</span>&gt;.<span class="type">Card</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">card</span>:<span class="type">MemoryGame</span>&lt;<span class="type">String</span>&gt;.<span class="type">Card</span>)&#123;</span><br><span class="line">        <span class="keyword">self</span>.card <span class="operator">=</span> card</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> base <span class="operator">=</span> <span class="type">RoundedRectangle</span>(cornerRadius: <span class="number">12</span>)</span><br><span class="line">            <span class="type">Group</span> &#123;</span><br><span class="line">                base.fill(.white)</span><br><span class="line">                base.strokeBorder(lineWidth: <span class="number">2</span>)</span><br><span class="line">                <span class="type">Text</span>(card.content)</span><br><span class="line">                    .font(.system(size: <span class="number">200</span>))</span><br><span class="line">                    .minimumScaleFactor(<span class="number">0.01</span>)</span><br><span class="line">                    .aspectRatio(<span class="number">1</span>, contentMode: .fit)</span><br><span class="line">            &#125;</span><br><span class="line">            .opacity(card.isFaceUp <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">            base.fill().opacity(card.isFaceUp <span class="operator">?</span> <span class="number">0</span> : <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .opacity(card.isFaceUp <span class="operator">||</span> <span class="operator">!</span>card.isMatched <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView_Previews</span>:<span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span>&#123;</span><br><span class="line">     <span class="type">CardView</span>(<span class="type">MemoryGame</span>&lt;<span class="type">String</span>&gt;.<span class="type">Card</span>(content: <span class="string">&quot;X&quot;</span>, id: <span class="string">&quot;test1&quot;</span>))</span><br><span class="line">        .padding()</span><br><span class="line">        .foregroundColor(.green)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-1-typealias"><a href="#2-1-1-typealias" class="headerlink" title="2.1.1 typealias"></a>2.1.1 typealias</h4><p>需要经常输入 <code>MemoryGame&lt;String&gt;.Card</code> 实在很麻烦，可以使用类型别名 <code>typealias</code> 来简化代码。我们首先在预览中设置类型别名。</p>
<blockquote>
<p><code>typealias</code> 为现有类型提供一个新的别名，使代码更简洁易读。当你需要使用复杂的类型（如嵌套类型或具有多个类型的 tuple）时，使用 <code>typealias</code> 可以让代码更清晰。</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CardView.swift</span></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> card: <span class="type">Card</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">card</span>:<span class="type">MemoryGame</span>&lt;<span class="type">String</span>&gt;.<span class="type">Card</span>)&#123;</span><br><span class="line">        <span class="keyword">self</span>.card <span class="operator">=</span> card</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView_Previews</span>:<span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">	<span class="keyword">typealias</span> <span class="type">Card</span> <span class="operator">=</span> <span class="type">MemoryGame</span>&lt;<span class="type">String</span>&gt;.<span class="type">Card</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span>&#123;</span><br><span class="line">    	<span class="type">CardView</span>(<span class="type">Card</span>(content: <span class="string">&quot;X&quot;</span>, id: <span class="string">&quot;test1&quot;</span>))</span><br><span class="line">    	    .padding()</span><br><span class="line">    	    .foregroundColor(.green)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是由于使用类型别名的命名空间不同，在 <code>struct CardView</code> 中无法将 <code>MemoryGame&lt;String&gt;.Card</code> 替换为 <code>Card</code>，需要在 <code>CardView</code> 结构体中再次使用类型别名 <code>typealias</code> 来简化代码。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CardView.swift</span></span><br><span class="line"><span class="operator">...</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">    <span class="keyword">typealias</span> <span class="type">Card</span> <span class="operator">=</span> <span class="type">MemoryGame</span>&lt;<span class="type">String</span>&gt;.<span class="type">Card</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> card: <span class="type">Card</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="keyword">_</span> <span class="params">card</span>:<span class="type">Card</span>)&#123;</span><br><span class="line">        <span class="keyword">self</span>.card <span class="operator">=</span> card</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="operator">...</span></span><br></pre></td></tr></table></figure>

<p>另外，对 <code>EmojiMemoryGame</code> 的 <code>MemoryGame&lt;String&gt;.Card</code> 做同样的处理。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//EmojiMemoryGame.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EmojiMemoryGame</span>:<span class="title class_ inherited__">ObservableObject</span>&#123;</span><br><span class="line">	<span class="keyword">typealias</span> <span class="type">Card</span> <span class="operator">=</span> <span class="type">MemoryGame</span>&lt;<span class="type">String</span>&gt;.<span class="type">Card</span></span><br><span class="line"></span><br><span class="line">	<span class="operator">...</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> cards: <span class="type">Array</span>&lt;<span class="type">Card</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> model.cards</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">choose</span>(<span class="keyword">_</span> <span class="params">card</span>:<span class="type">Card</span>)&#123;</span><br><span class="line">        model.choose(card)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>由于我们在 <code>CardView</code> 结构体中已经定义了类型别名，我们可以将预览中的类型别名赋值为 <code>CardView.Card</code>，还可以创建多个 CardView 视图来提供预览效果。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CardView.swift</span></span><br><span class="line"><span class="operator">...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView_Previews</span>: <span class="title class_ inherited__">PreviewProvider</span> &#123;</span><br><span class="line">       <span class="keyword">typealias</span> <span class="type">Card</span> <span class="operator">=</span> <span class="type">CardView</span>.<span class="type">Card</span></span><br><span class="line">       <span class="keyword">static</span> <span class="keyword">var</span> previews: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">           <span class="type">VStack</span> &#123;</span><br><span class="line">               <span class="type">HStack</span> &#123;</span><br><span class="line">                   <span class="type">CardView</span>(<span class="type">Card</span>(isFaceUp: <span class="literal">true</span>, content: <span class="string">&quot;X&quot;</span>, id: <span class="string">&quot;test1&quot;</span>))</span><br><span class="line">                   <span class="type">CardView</span>(<span class="type">Card</span>(content: <span class="string">&quot;X&quot;</span>, id: <span class="string">&quot;test1&quot;</span>))</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">               <span class="type">HStack</span> &#123;</span><br><span class="line">                   <span class="type">CardView</span>(<span class="type">Card</span>(isFaceUp: <span class="literal">true</span>, isMatched: <span class="literal">true</span>, content: <span class="string">&quot;long long long string and i hope it fits&quot;</span>,id: <span class="string">&quot;test1&quot;</span>))</span><br><span class="line">                   <span class="type">CardView</span>(<span class="type">Card</span>(content: <span class="string">&quot;X&quot;</span>, id: <span class="string">&quot;test1&quot;</span>))</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">           &#125;</span><br><span class="line">           .padding()</span><br><span class="line">           .foregroundColor(.green)</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>预览效果如下：</p>
<!-- 使图片居中显示 -->
<div style="text-align:center">
    <img src="/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/cs193p|07|1.png">
</div>

<p>我们发现在有多行文本时，视图文本会靠左对齐，对 <code>CardView</code> 视图进行调整使其在多行文本时居中显示。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CardView.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">	<span class="operator">...</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">        	<span class="operator">...</span></span><br><span class="line">            <span class="type">Group</span> &#123;</span><br><span class="line">            	<span class="operator">...</span></span><br><span class="line">                <span class="type">Text</span>(card.content)</span><br><span class="line">                    .font(.system(size: <span class="number">200</span>))</span><br><span class="line">                    .minimumScaleFactor(<span class="number">0.01</span>)</span><br><span class="line">                    .multilineTextAlignment(.center)</span><br><span class="line">                    .aspectRatio(<span class="number">1</span>, contentMode: .fit)</span><br><span class="line">                    .padding()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="operator">...</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="operator">...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-处理常量"><a href="#2-2-处理常量" class="headerlink" title="2.2 处理常量"></a>2.2 处理常量</h3><p>为了更方便对视图的布局进行统一调整，我们使用私有结构体来为这些视图调整器的常量创建命名空间，并声明类型。这样可以使得代码结构更清晰。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CardView.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView</span>:<span class="title class_ inherited__">View</span>&#123;</span><br><span class="line">	<span class="operator">...</span></span><br><span class="line">	<span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">	        <span class="type">ZStack</span> &#123;</span><br><span class="line">	            <span class="keyword">let</span> base <span class="operator">=</span> <span class="type">RoundedRectangle</span>(cornerRadius: <span class="type">Constants</span>.cornerRadius)</span><br><span class="line">	            <span class="type">Group</span> &#123;</span><br><span class="line">	                base.fill(.white)</span><br><span class="line">	                base.strokeBorder(lineWidth: <span class="type">Constants</span>.lineWidth)</span><br><span class="line">	                <span class="type">Text</span>(card.content)</span><br><span class="line">	                    .font(.system(size: <span class="type">Constants</span>.<span class="type">FontSize</span>.largest))</span><br><span class="line">	                    .minimumScaleFactor(<span class="type">Constants</span>.<span class="type">FontSize</span>.scaleFactor)</span><br><span class="line">	                    .multilineTextAlignment(.center)</span><br><span class="line">	                    .aspectRatio(<span class="number">1</span>, contentMode: .fit)</span><br><span class="line">	                    .padding(<span class="type">Constants</span>.in<span class="keyword">set</span>)</span><br><span class="line">	            &#125;</span><br><span class="line">	            .opacity(card.isFaceUp <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">	            base.fill().opacity(card.isFaceUp <span class="operator">?</span> <span class="number">0</span> : <span class="number">1</span>)</span><br><span class="line">	        &#125;</span><br><span class="line">	        .opacity(card.isFaceUp <span class="operator">||</span> <span class="operator">!</span>card.isMatched <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">	    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">struct</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">let</span> cornerRadius:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">12</span></span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">let</span> lineWidth:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">		<span class="keyword">static</span> <span class="keyword">let</span> inset:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">5</span></span><br><span class="line">		<span class="keyword">struct</span> <span class="title class_">FontSize</span> &#123;</span><br><span class="line">			<span class="keyword">static</span> <span class="keyword">let</span> largest:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">200</span></span><br><span class="line">			<span class="keyword">static</span> <span class="keyword">let</span> smallest:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">10</span></span><br><span class="line">			<span class="keyword">static</span> <span class="keyword">let</span> scaleFactor <span class="operator">=</span> smallest <span class="operator">/</span> largest</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>但我们会注意到，还会有一些常量 <code>1</code> 、<code>0</code> 或者颜色常量没有添加到结构体中，因为通常不具有特别的意义，当然根据情况也可以添加到私其中。</p>
<p>另外，还有一些特别的颜色，比如卡片游戏中的颜色背景，没有添加。因为我们希望将其置于视图层级来调整它们，它属于游戏配置。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//EmojiMemoryGameView.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">EmojiMemoryGameView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">	<span class="operator">...</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>&#123;</span><br><span class="line">            cards</span><br><span class="line">                .foregroundColor(viewModel.color)</span><br><span class="line">                .animation(.default, value: viewModel.cards)</span><br><span class="line">                .padding()</span><br><span class="line">		<span class="operator">...</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> cards: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">AspectVGrid</span>(items:viewModel.cards,aspectRatio:aspectRatio) &#123; card <span class="keyword">in</span></span><br><span class="line">            <span class="type">CardView</span>(card)</span><br><span class="line">                .aspectRatio(aspectRatio, contentMode: .fit)</span><br><span class="line">                .padding(<span class="number">8</span>)</span><br><span class="line">                .onTapGesture &#123;</span><br><span class="line">                    viewModel.choose(card)</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//EmojiMemoryGame.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EmojiMemoryGame</span>:<span class="title class_ inherited__">ObservableObject</span> &#123;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">    <span class="keyword">var</span> color:<span class="type">Color</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> .orange</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-图形（Shape）"><a href="#2-图形（Shape）" class="headerlink" title="2. 图形（Shape）"></a><strong>2. 图形（Shape）</strong></h2><p><code>Shape</code> 是一种继承自 <code>View</code> 的协议（protocol），也就是说，所有的 <code>shape</code> 都是 <code>View</code>，比如 <code>RoundedRectangle</code> 、<code>Circle</code>、<code>Capsule</code> 等。</p>
<h3 id="2-1-绘制自定义图形"><a href="#2-1-绘制自定义图形" class="headerlink" title="2.1 绘制自定义图形"></a><strong>2.1 绘制自定义图形</strong></h3><p>自定义图形的实现基于 SwiftUI 的 <code>Shape</code> 协议：</p>
<h4 id="2-1-1-Shape-协议的默认行为："><a href="#2-1-1-Shape-协议的默认行为：" class="headerlink" title="2.1.1 Shape 协议的默认行为："></a>2.1.1 <strong><code>Shape</code> 协议的默认行为：</strong></h4><p>图形通过当前的前景色（<code>foregroundColor</code>）进行填充。也可以使用 <code>.fill()</code> 和 <code>.stroke()</code> 方法自定义绘制方式。</p>
<p>这些修饰符返回一个以指定方式（通过描边或填充）绘制形状的视图。在我们的演示中，<code>fill</code> 的参数看起来是一个颜色（例如，<code>Color.white</code>）。但情况并非完全如此…</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">fill</span>&lt;<span class="type">S</span>&gt;(<span class="keyword">_</span> <span class="params">whatToFillWith</span>: <span class="type">S</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> <span class="keyword">where</span> <span class="type">S</span>: <span class="type">ShapeStyle</span></span><br></pre></td></tr></table></figure>

<p>这是一个泛型函数（类似于但不同于泛型类型）。<code>S</code> 是一个不关心的类型（但由于有 <code>where</code> 语句，它变成了“稍微关心一下”）。<code>S</code> 可以是任何实现了 <code>ShapeStyle</code> 协议的类型。<code>ShapeStyle</code> 协议通过对形状应用某些样式<strong>将形状转换为视图</strong>。这样的例子包括：<code>Color</code>、<code>ImagePaint</code>、<code>AngularGradient</code>、<code>LinearGradient</code>。</p>
<h4 id="2-1-2-实现-Shape-协议的方法："><a href="#2-1-2-实现-Shape-协议的方法：" class="headerlink" title="2.1.2 实现 Shape 协议的方法："></a>2.1.2 <strong>实现 <code>Shape</code> 协议的方法：</strong></h4><p>但是要怎么实现自定义 <code>Shape</code> 呢？</p>
<p>实现 <code>shape</code> 协议必须实现以下方法：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">path</span>(<span class="params">in</span> <span class="params">rect</span>: <span class="type">CGRect</span>) -&gt; <span class="type">Path</span></span><br></pre></td></tr></table></figure>

<p>该方法返回一个 <code>Path</code>，用于定义图形的路径。</p>
<p><strong>Path 的能力：</strong></p>
<ul>
<li>支持添加线条、弧线、贝塞尔曲线等。</li>
<li>可以通过组合这些路径创建任意形状。</li>
</ul>
<h3 id="2-2-Demo-示例：绘制一个未动画化的“倒计时饼图”"><a href="#2-2-Demo-示例：绘制一个未动画化的“倒计时饼图”" class="headerlink" title="2.2 Demo 示例：绘制一个未动画化的“倒计时饼图”"></a>2.2 Demo 示例：绘制一个未动画化的“倒计时饼图”</h3><p>为了更清晰的观察饼图的样式:</p>
<ul>
<li>我们先将卡片数量设置为 4 张（EmojiMemoryGame.swift）</li>
<li>使卡片默认朝上(MemoryGame.swift)</li>
<li>在 Card 中添加一个 <code>Circle</code> 并调整 <code>padding</code> 和 <code>opacity</code>，将 <code>Text</code> 放置在 <code>circle</code> 的 <code>overlay</code> 中，由于 <code>padding</code> 和 <code>opacity</code> 的值为常数，我们将其添加到下面的常量中（CardView.swift）</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  EMojiMemoryGame.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EmojiMemoryGame</span>:<span class="title class_ inherited__">ObservableObject</span> &#123;</span><br><span class="line">	<span class="operator">...</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">createMemoryGame</span>() -&gt; <span class="type">MemoryGame</span>&lt;<span class="type">String</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">MemoryGame</span>(numberOfPairsOfCards: <span class="number">2</span>) &#123; <span class="type">Index</span> <span class="keyword">in</span></span><br><span class="line">        	<span class="operator">...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="operator">...</span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//MemoryGame.swift</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MemoryGame</span>&lt;<span class="type">CardContent</span>&gt; <span class="keyword">where</span> <span class="type">CardContent</span>: <span class="type">Equatable</span> &#123;</span><br><span class="line">	<span class="operator">...</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Card</span>: <span class="title class_ inherited__">Equatable</span>,<span class="title class_ inherited__">Identifiable</span>,<span class="title class_ inherited__">CustomDebugStringConvertible</span>  &#123;</span><br><span class="line">		<span class="operator">...</span></span><br><span class="line">        <span class="keyword">var</span> isFaceUp <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line">		<span class="operator">...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="operator">...</span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  CardView.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">	<span class="operator">...</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">		 <span class="type">ZStack</span> &#123;</span><br><span class="line">			 <span class="keyword">let</span> base <span class="operator">=</span> <span class="type">RoundedRectangle</span>(cornerRadius: <span class="type">Constants</span>.cornerRadius)</span><br><span class="line">			 <span class="type">Group</span> &#123;</span><br><span class="line">				 base.fill(.white)</span><br><span class="line">				 base.strokeBorder(lineWidth: <span class="type">Constants</span>.lineWidth)</span><br><span class="line">				 <span class="type">Circle</span>()</span><br><span class="line">					 .opacity(<span class="type">Constants</span>.<span class="type">Pie</span>.opacity)</span><br><span class="line">					 .overlay(</span><br><span class="line">						 <span class="type">Text</span>(card.content)</span><br><span class="line">							 .font(.system(size: <span class="type">Constants</span>.<span class="type">FontSize</span>.largest))</span><br><span class="line">							 .minimumScaleFactor(<span class="type">Constants</span>.<span class="type">FontSize</span>.scaleFactor)</span><br><span class="line">							 .multilineTextAlignment(.center)</span><br><span class="line">							 .aspectRatio(<span class="number">1</span>, contentMode: .fit)</span><br><span class="line">							 .padding(<span class="type">Constants</span>.<span class="type">Pie</span>.in<span class="keyword">set</span>)</span><br><span class="line">					 )</span><br><span class="line">					 .padding(<span class="type">Constants</span>.in<span class="keyword">set</span>)</span><br><span class="line"></span><br><span class="line">			 &#125;</span><br><span class="line">			 .opacity(card.isFaceUp <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">			 base.fill().opacity(card.isFaceUp <span class="operator">?</span> <span class="number">0</span> : <span class="number">1</span>)</span><br><span class="line">		 &#125;</span><br><span class="line">		 .opacity(card.isFaceUp <span class="operator">||</span> <span class="operator">!</span>card.isMatched <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">struct</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">	   <span class="keyword">static</span> <span class="keyword">let</span> cornerRadius:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">12</span></span><br><span class="line">	   <span class="keyword">static</span> <span class="keyword">let</span> lineWidth:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">	   <span class="keyword">static</span> <span class="keyword">let</span> inset:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">5</span></span><br><span class="line">	   <span class="keyword">struct</span> <span class="title class_">FontSize</span> &#123;</span><br><span class="line">		   <span class="keyword">static</span> <span class="keyword">let</span> largest:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">200</span></span><br><span class="line">		   <span class="keyword">static</span> <span class="keyword">let</span> smallest:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">10</span></span><br><span class="line">		   <span class="keyword">static</span> <span class="keyword">let</span> scaleFactor <span class="operator">=</span> smallest <span class="operator">/</span> largest</span><br><span class="line">	   &#125;</span><br><span class="line"></span><br><span class="line">	   <span class="keyword">struct</span> <span class="title class_">Pie</span> &#123;</span><br><span class="line">		   <span class="keyword">static</span> <span class="keyword">let</span> opacity:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">0.5</span></span><br><span class="line">		   <span class="keyword">static</span> <span class="keyword">let</span> inset:<span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">5</span></span><br><span class="line">	   &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="operator">...</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-1-创建一个-Pie（shape）"><a href="#2-2-1-创建一个-Pie（shape）" class="headerlink" title="2.2.1 创建一个 Pie（shape）"></a>2.2.1 创建一个 Pie（shape）</h4><p>虽然 <code>Pie</code> 是一个 <code>View</code>，但它是一个 <code>Shape</code>，所以我们创建一个 <code>swift</code> 文档，而非 <code>swiftUI</code>。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  Pie.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> CoreGraphics</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Pie</span>: <span class="title class_ inherited__">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> startAngle: <span class="type">Angle</span> <span class="operator">=</span> .zero</span><br><span class="line">    <span class="keyword">let</span> endAngle: <span class="type">Angle</span></span><br><span class="line">    <span class="comment">// 顺时针</span></span><br><span class="line">    <span class="keyword">var</span> clockwise <span class="operator">=</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Shape协议 方法</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">path</span>(<span class="params">in</span> <span class="params">rect</span>: <span class="type">CGRect</span>) -&gt; <span class="type">Path</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> center <span class="operator">=</span> <span class="type">CGPoint</span>(x: rect.midX, y: rect.midY)</span><br><span class="line">        <span class="keyword">let</span> radius <span class="operator">=</span> <span class="built_in">min</span>(rect.width, rect.height) <span class="operator">/</span> <span class="number">2</span></span><br><span class="line">        <span class="keyword">let</span> start <span class="operator">=</span> <span class="type">CGPoint</span>(</span><br><span class="line">            x: center.x <span class="operator">+</span> radius <span class="operator">*</span> cos(startAngle.radians),</span><br><span class="line">            y: center.y <span class="operator">+</span> radius <span class="operator">*</span> sin(startAngle.radians)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> p <span class="operator">=</span> <span class="type">Path</span>()</span><br><span class="line">        p.move(to: center)</span><br><span class="line">        p.addLine(to: start)</span><br><span class="line">        p.addArc(</span><br><span class="line">            center: center,</span><br><span class="line">            radius: radius,</span><br><span class="line">            startAngle: startAngle,</span><br><span class="line">            endAngle: endAngle,</span><br><span class="line">            clockwise: clockwise</span><br><span class="line">        )</span><br><span class="line">        p.addLine(to: center)</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>再将 <code>CardView.swift</code> 中的 <code>circle()</code> 改为 <code>Pie()</code>。</p>
<p>我们试图创建一个从 12 点钟方向到 8 点钟方向的顺时针饼图，但这似乎不太对劲：</p>
<p><img src="/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/cs193p%7C07%7C2.png"></p>
<p>因为这的 0 度和时钟不同，它遵循直角坐标系，是 x 轴正向。</p>
<p>另外，此处的坐标系原点是在左上角，y 轴正向是向下的，所以顺时针方向也和通常的情况相反。接下来进行修正。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  Pie.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Pie</span>: <span class="title class_ inherited__">Shape</span> &#123;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">path</span>(<span class="params">in</span> <span class="params">rect</span>: <span class="type">CGRect</span>) -&gt; <span class="type">Path</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> startAngle <span class="operator">=</span> startAngle <span class="operator">-</span> .degrees(<span class="number">90</span>)</span><br><span class="line">        <span class="keyword">let</span> endAngle <span class="operator">=</span> endAngle <span class="operator">-</span> .degrees(<span class="number">90</span>)</span><br><span class="line">        <span class="operator">...</span></span><br><span class="line">        p.addArc(</span><br><span class="line">            center: center,</span><br><span class="line">            radius: radius,</span><br><span class="line">            startAngle: startAngle,</span><br><span class="line">            endAngle: endAngle,</span><br><span class="line">            clockwise: <span class="operator">!</span>clockwise</span><br><span class="line">        )</span><br><span class="line">		<span class="operator">...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>修正后预览效果如下：</p>
<p><img src="/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/cs193p%7C07%7C3.png"></p>
<h2 id="3-动画（Animation）"><a href="#3-动画（Animation）" class="headerlink" title="3. 动画（Animation）"></a><strong>3. 动画（Animation）</strong></h2><h3 id="3-1-动画的工作原理"><a href="#3-1-动画的工作原理" class="headerlink" title="3.1 动画的工作原理"></a><strong>3.1 动画的工作原理</strong></h3><p>动画是提升移动端用户界面交互体验的重要组成部分。</p>
<p>SwiftUI 提供了便捷的动画工具：</p>
<ul>
<li>通过 Shape 动画化图形。</li>
<li>使用 ViewModifiers 动画化视图。</li>
</ul>
<h3 id="3-2-示例：动画化-Shape"><a href="#3-2-示例：动画化-Shape" class="headerlink" title="3.2 示例：动画化 Shape"></a><strong>3.2 示例：动画化 Shape</strong></h3><p>动画化一个 <code>Shape</code>（例如移动的饼图）：</p>
<ul>
<li>可以通过在 <code>Shape</code> 的属性上添加动画支持。</li>
<li>示例将在下一节演示中补充。</li>
</ul>
<hr>
<h2 id="4-视图修饰符（ViewModifier）"><a href="#4-视图修饰符（ViewModifier）" class="headerlink" title="4. 视图修饰符（ViewModifier）"></a><strong>4. 视图修饰符（ViewModifier）</strong></h2><h3 id="4-1-什么是-ViewModifier？"><a href="#4-1-什么是-ViewModifier？" class="headerlink" title="4.1 什么是 ViewModifier？"></a><strong>4.1 什么是 ViewModifier？</strong></h3><p>SwiftUI 中的修饰符（如 <code>foregroundColor</code>、<code>font</code>、<code>padding</code>）是如何工作的？</p>
<p>它们是 <code>ViewModifier</code> 协议的实现。示例：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.aspectRatio(<span class="number">2</span><span class="operator">/</span><span class="number">3</span>)</span><br><span class="line"><span class="comment">// 实际上等价于：</span></span><br><span class="line">.modifier(<span class="type">AspectModifier</span>(<span class="number">2</span><span class="operator">/</span><span class="number">3</span>))</span><br></pre></td></tr></table></figure>

<p><strong><code>ViewModifier</code> 的核心功能</strong>是通过 <code>body(content:)</code> 方法接收一个视图并返回修改后的视图。 <code>ViewModifier</code> 协议只有一个函数。这个函数的唯一任务是根据传入的内容创建一个新的视图。从概念上讲，这个协议大致如下：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">ViewModifier</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="comment">// Content 是一个“稍微关心一下”的视图，即被修饰的视图</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">some</span> <span class="type">View，几乎肯定会包含内容</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当我们在一个视图上调用 <code>modifier</code> 时，传递给这个 <code>body</code> 函数的内容就是该视图。例如：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aView.modifier(<span class="type">MyViewModifier</span>(arguments: <span class="operator">...</span>))</span><br></pre></td></tr></table></figure>

<p><code>MyViewModifier</code> 实现了 <code>ViewModifier</code> 协议，而 <code>aView</code> 将通过 <code>content</code> 传递给它的 <code>body</code> 函数。</p>
<h3 id="4-2-创建自定义-ViewModifier"><a href="#4-2-创建自定义-ViewModifier" class="headerlink" title="4.2 创建自定义 ViewModifier"></a><strong>4.2 创建自定义 ViewModifier</strong></h3><p><strong>目标</strong></p>
<ul>
<li>将任意视图转换为“卡片”样式。</li>
</ul>
<p><strong>使用方法</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(<span class="string">&quot;Hello&quot;</span>)</span><br><span class="line">	.modifier(<span class="type">Cardify</span>(isFaceUp: <span class="literal">true</span>))</span><br></pre></td></tr></table></figure>

<p><code>.modifier</code> 将返回一个如下的视图</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Cardify</span>: <span class="title class_ inherited__">ViewModifier</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> isFaceUp: <span class="type">Bool</span></span><br><span class="line">	<span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">		<span class="type">ZStack</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> isFaceUp &#123;</span><br><span class="line">				<span class="type">RoundedRectangle</span>(cornerRadius: <span class="number">10</span>).fill(<span class="type">Color</span>.white)</span><br><span class="line">				<span class="type">RoundedRectangle</span>(cornerRadius: <span class="number">10</span>).stroke()</span><br><span class="line">				content</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="type">RoundedRectangle</span>(cornerRadius: <span class="number">10</span>).fill(<span class="type">Color</span>.gray)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那我们要如何将其从 <code>.modifier(Cardify(isFaceUp: true))</code> 转变为 <code>.cardify(isFaceUp:true)</code> 呢？通过 <code>extension</code> 来实现</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">View</span> &#123;</span><br><span class="line">   <span class="keyword">func</span> <span class="title function_">cardify</span>(<span class="params">isFaceUp</span>: <span class="type">Bool</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">	   modifier(<span class="type">Cardify</span>(isFaceUp: isFaceUp))</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-3-Demo：：实现-Cardify-修饰符"><a href="#4-3-Demo：：实现-Cardify-修饰符" class="headerlink" title="4.3 Demo：：实现 Cardify 修饰符"></a>4.3 Demo：：实现 <code>Cardify</code> 修饰符</h3><p>因为不需要预览（preview），所以创建一个 swift 文件，命名为 <code>Cardify.swift</code> 。</p>
<p>我们在 <code>CardView</code> 中截取 Card 部分，并删除会被 <code>Cardify</code> 的部分（即饼图）作为 content，并声明私有结构体 <code>Constants</code> 创建常数的命名空间。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  Cardify.swift</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Cardify</span>: <span class="title class_ inherited__">ViewModifier</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> isFaceUp: <span class="type">Bool</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">        	<span class="keyword">let</span> base <span class="operator">=</span> <span class="type">RoundedRectangle</span>(cornerRadius: <span class="type">Constants</span>.cornerRadius)</span><br><span class="line">        	<span class="type">Group</span> &#123;</span><br><span class="line">        		base.fill(.white)</span><br><span class="line">        		base.strokeBorder(lineWidth: <span class="type">Constants</span>.lineWidth)</span><br><span class="line">        		content</span><br><span class="line">			 &#125;</span><br><span class="line">			 .opacity(isFaceUp <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">            base.fill()</span><br><span class="line">                .opacity(isFaceUp <span class="operator">?</span> <span class="number">0</span> : <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">struct</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">let</span> cornerRadius: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">12</span></span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">let</span> lineWidth: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  CardView.swift</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">   	<span class="operator">...</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Pie</span>(endAngle: .degrees(<span class="number">240</span>))</span><br><span class="line">            .opacity(<span class="type">Constants</span>.<span class="type">Pie</span>.opacity)</span><br><span class="line">            .overlay(</span><br><span class="line">                <span class="type">Text</span>(card.content)</span><br><span class="line">                    .font(.system(size: <span class="type">Constants</span>.<span class="type">FontSize</span>.largest))</span><br><span class="line">                    .minimumScaleFactor(<span class="type">Constants</span>.<span class="type">FontSize</span>.scaleFactor)</span><br><span class="line">                    .multilineTextAlignment(.center)</span><br><span class="line">                    .aspectRatio(<span class="number">1</span>, contentMode: .fit)</span><br><span class="line">                    .padding(<span class="type">Constants</span>.<span class="type">Pie</span>.in<span class="keyword">set</span>)</span><br><span class="line">            )</span><br><span class="line">            .padding(<span class="type">Constants</span>.in<span class="keyword">set</span>)</span><br><span class="line">            .modifier(<span class="type">Cardify</span>(isFaceUp: card.isFaceUp))</span><br><span class="line">            .opacity(card.isFaceUp <span class="operator">||</span> <span class="operator">!</span>card.isMatched <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">struct</span> <span class="title class_">Constants</span> &#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">let</span> inset: <span class="type">CGFloat</span> <span class="operator">=</span> <span class="number">5</span></span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">FontSize</span> &#123;</span><br><span class="line">        	<span class="operator">...</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">Pie</span> &#123;</span><br><span class="line">            <span class="operator">...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="operator">...</span></span><br></pre></td></tr></table></figure>

<p>我们想将 <code>.modifier</code> 变为 <code>.cardify</code> 则需要添加一个协议扩展：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Cardify.swift</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Cardify</span>: <span class="title class_ inherited__">ViewModifier</span> &#123;</span><br><span class="line">	<span class="operator">...</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">body</span>(<span class="params">content</span>: <span class="type">Content</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ZStack</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> base <span class="operator">=</span> <span class="type">RoundedRectangle</span>(cornerRadius: <span class="type">Constants</span>.cornerRadius)</span><br><span class="line">            base.strokeBorder(lineWidth: <span class="type">Constants</span>.lineWidth)</span><br><span class="line">                .background(base.fill(.white))</span><br><span class="line">                .overlay(content)</span><br><span class="line">                .opacity(isFaceUp <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">            base.fill()</span><br><span class="line">                .opacity(isFaceUp <span class="operator">?</span> <span class="number">0</span> : <span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extension</span> <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">cardify</span>(<span class="params">isFaceUp</span>: <span class="type">Bool</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        modifier(<span class="type">Cardify</span>(isFaceUp: isFaceUp))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  CardView.swift</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">CardView</span>: <span class="title class_ inherited__">View</span> &#123;</span><br><span class="line">   	<span class="operator">...</span></span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Pie</span>(endAngle: .degrees(<span class="number">240</span>))</span><br><span class="line">            .opacity(<span class="type">Constants</span>.<span class="type">Pie</span>.opacity)</span><br><span class="line">            .overlay(</span><br><span class="line">                <span class="operator">...</span></span><br><span class="line">            )</span><br><span class="line">            .padding(<span class="type">Constants</span>.in<span class="keyword">set</span>)</span><br><span class="line">            .<span class="type">Cardify</span>(isFaceUp: card.isFaceUp)</span><br><span class="line">            .opacity(card.isFaceUp <span class="operator">||</span> <span class="operator">!</span>card.isMatched <span class="operator">?</span> <span class="number">1</span> : <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="operator">...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="operator">...</span></span><br></pre></td></tr></table></figure>

<h2 id="5-协议（Protocol）"><a href="#5-协议（Protocol）" class="headerlink" title="5. 协议（Protocol）"></a><strong>5. 协议（Protocol）</strong></h2><h3 id="5-1-协议的用途"><a href="#5-1-协议的用途" class="headerlink" title="5.1 协议的用途"></a>5.1 协议的用途</h3><h4 id="5-1-1-协议的核心作用"><a href="#5-1-1-协议的核心作用" class="headerlink" title="5.1.1 协议的核心作用"></a><strong>5.1.1 协议的核心作用</strong></h4><ul>
<li>协议是 Swift 中用于<strong>定义行为和约定</strong>的工具。</li>
<li>它是代码共享的核心，允许在多个类型之间复用功能。</li>
<li>协议可以通过<strong>扩展（<code>extension</code>）</strong>来添加实现。<ul>
<li>示例：<ul>
<li><code>View</code> 协议的扩展为视图提供了许多修饰符，例如 <code>foregroundColor</code> 和 <code>font</code>。</li>
<li>通过扩展，开发者可以在协议中添加函数和属性的默认实现。</li>
<li>例如：<code>ObservableObject</code> 协议通过扩展获得了 <code>objectWillChange</code> 的默认实现。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="5-1-2-协议扩展的例子"><a href="#5-1-2-协议扩展的例子" class="headerlink" title="5.1.2 协议扩展的例子"></a><strong>5.1.2 协议扩展的例子</strong></h4><h5 id="5-1-2-1-示例-1：在协议中添加修饰符功能"><a href="#5-1-2-1-示例-1：在协议中添加修饰符功能" class="headerlink" title="5.1.2.1 示例 1：在协议中添加修饰符功能"></a><strong>5.1.2.1 示例 1：在协议中添加修饰符功能</strong></h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">foregroundColor</span>(<span class="keyword">_</span> <span class="params">color</span>: <span class="type">Color</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="comment">// 实现代码</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">font</span>(<span class="keyword">_</span> <span class="params">font</span>: <span class="type">Font</span>?) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="comment">// 实现代码</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>这些扩展使视图类型（如 <code>Text</code> 和 <code>Image</code>）自动获得上述修饰符功能。</li>
</ul>
<h5 id="5-1-2-2-示例-2：filter-的实现"><a href="#5-1-2-2-示例-2：filter-的实现" class="headerlink" title="5.1.2.2 示例 2：filter 的实现"></a><strong>5.1.2.2 示例 2：<code>filter</code> 的实现</strong></h5><p><code>filter</code> 函数通过扩展被添加到 <code>Sequence</code> 协议中：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">Sequence</span> &#123;</span><br><span class="line">	<span class="keyword">func</span> <span class="title function_">filter</span>(<span class="keyword">_</span> <span class="params">isIncluded</span>: (<span class="type">Element</span>) -&gt; <span class="type">Bool</span>) -&gt; [<span class="type">Element</span>] &#123;</span><br><span class="line">		<span class="comment">// 实现代码</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这意味着，<code>filter</code> 可以直接用于 <code>Array</code>、<code>Range</code> 和 <code>Dictionary</code> 等类型，而无需单独实现。</p>
<h3 id="5-2-泛型与协议"><a href="#5-2-泛型与协议" class="headerlink" title="5.2 泛型与协议"></a><strong>5.2 泛型与协议</strong></h3><h4 id="5-2-1-协议中的泛型类型"><a href="#5-2-1-协议中的泛型类型" class="headerlink" title="5.2.1 协议中的泛型类型"></a><strong>5.2.1 协议中的泛型类型</strong></h4><ul>
<li>协议支持泛型（”don’t care” 类型），允许它与不同类型结合使用。</li>
<li><strong><code>associatedtype</code> 关键字：</strong><ul>
<li>用于声明协议中的泛型类型。</li>
<li>示例：<code>Identifiable</code> 协议：<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">ID</span></span><br><span class="line">    <span class="keyword">var</span> id: <span class="type">ID</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ID</code> 是一个泛型类型，它可以是任何类型。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="5-2-2-使用泛型约束"><a href="#5-2-2-使用泛型约束" class="headerlink" title="5.2.2 使用泛型约束"></a><strong>5.2.2 使用泛型约束</strong></h4><ul>
<li>可以通过泛型约束限制泛型类型的行为。<ul>
<li>示例：让 <code>ID</code> 必须遵循 <code>Hashable</code> 协议：<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">ID</span>: <span class="type">Hashable</span></span><br><span class="line">    <span class="keyword">var</span> id: <span class="type">ID</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>解释：<ul>
<li><code>Hashable</code> 是一个协议，保证 <code>ID</code> 可以被用于哈希表中（例如字典或集合）。</li>
<li>这样可以确保 <code>Identifiable</code> 类型的对象是可查找的。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="5-3-View-协议与-SwiftUI-类型系统"><a href="#5-3-View-协议与-SwiftUI-类型系统" class="headerlink" title="5.3 View 协议与 SwiftUI 类型系统"></a><strong>5.3 <code>View</code> 协议与 SwiftUI 类型系统</strong></h3><h4 id="5-3-1-View-协议的结构"><a href="#5-3-1-View-协议的结构" class="headerlink" title="5.3.1 View 协议的结构"></a><strong>5.3.1 <code>View</code> 协议的结构</strong></h4><ul>
<li>SwiftUI 中的 <code>View</code> 协议大致如下：<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>所有的视图（如 <code>Text</code>、<code>Button</code> 等）都需要实现 <code>body</code> 属性，并返回一个符合 <code>View</code> 协议的类型。</li>
</ul>
</li>
</ul>
<h4 id="5-3-2-扩展-View-协议"><a href="#5-3-2-扩展-View-协议" class="headerlink" title="5.3.2 扩展 View 协议"></a><strong>5.3.2 扩展 <code>View</code> 协议</strong></h4><ul>
<li>通过扩展 <code>View</code> 协议，SwiftUI 添加了许多常用功能：<ul>
<li>修饰符方法（如 <code>foregroundColor</code> 和 <code>font</code>）：<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extension</span> <span class="title class_">View</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">foregroundColor</span>(<span class="keyword">_</span> <span class="params">color</span>: <span class="type">Color</span>) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="comment">// 实现</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">font</span>(<span class="keyword">_</span> <span class="params">font</span>: <span class="type">Font</span>?) -&gt; <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">        <span class="comment">// 实现</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>这些方法为实现了 <code>View</code> 协议的所有类型（如 <code>Text</code>）提供了额外的功能。</li>
</ul>
</li>
</ul>
<h3 id="5-4-some-和-any-的用法"><a href="#5-4-some-和-any-的用法" class="headerlink" title="5.4 some 和 any 的用法"></a><strong>5.4 <code>some</code> 和 <code>any</code> 的用法</strong></h3><h4 id="5-4-1-some-关键字"><a href="#5-4-1-some-关键字" class="headerlink" title="5.4.1 some 关键字"></a><strong>5.4.1 <code>some</code> 关键字</strong></h4><ul>
<li><code>some</code> 用于返回<strong>不透明类型</strong>。</li>
<li><strong>返回不透明类型的示例：</strong><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">RoundedRectangle</span>(cornerRadius: <span class="number">10</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>body</code> 的返回值是 <code>some View</code>，表示它返回的是一种符合 <code>View</code> 协议的具体类型，但具体是什么类型由 Swift 推断。</li>
<li>注意：<code>some</code> 类型在所有执行路径中必须一致。</li>
</ul>
</li>
</ul>
<h4 id="5-4-2-使用-some-创建函数示例"><a href="#5-4-2-使用-some-创建函数示例" class="headerlink" title="5.4.2 使用 some 创建函数示例"></a><strong>5.4.2 使用 <code>some</code> 创建函数示例</strong></h4><p>示例：返回不同的 <code>Shape</code> 类型：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">getShape</span>(<span class="params">rounded</span>: <span class="type">Bool</span>) -&gt; <span class="keyword">some</span> <span class="type">Shape</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> rounded &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">RoundedRectangle</span>(cornerRadius: <span class="number">12</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Rectangle</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回值是 <code>some Shape</code>，保证调用方只需知道结果是某种 <code>Shape</code>。</p>
<h4 id="5-4-3-any-关键字"><a href="#5-4-3-any-关键字" class="headerlink" title="5.4.3 any 关键字"></a><strong>5.4.3 <code>any</code> 关键字</strong></h4><ul>
<li><p><code>any</code> 用于创建协议类型的异构集合。</p>
</li>
<li><p><strong>示例：协议类型数组</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ids: [<span class="keyword">any</span> <span class="type">Identifiable</span>] <span class="operator">=</span> []</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ids</code> 是一个可以存放不同 <code>Identifiable</code> 类型实例的数组。</li>
</ul>
</li>
<li><p><strong>限制：</strong></p>
<ul>
<li>要操作 <code>any</code> 协议类型的对象，必须通过接受具体协议的函数。</li>
<li>示例：<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">func</span> <span class="title function_">printId</span>(<span class="params">of</span> <span class="params">identifiable</span>: <span class="keyword">some</span> <span class="type">Identifiable</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(identifiable.id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="5-6-Identifiable-协议的例子"><a href="#5-6-Identifiable-协议的例子" class="headerlink" title="5.6 Identifiable 协议的例子"></a><strong>5.6 <code>Identifiable</code> 协议的例子</strong></h3><h4 id="5-6-1-协议定义"><a href="#5-6-1-协议定义" class="headerlink" title="5.6.1 协议定义"></a><strong>5.6.1 协议定义</strong></h4><ul>
<li><code>Identifiable</code> 是一个 Swift 标准库协议，定义如下：<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">ID</span>: <span class="type">Hashable</span></span><br><span class="line">    <span class="keyword">var</span> id: <span class="type">ID</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>用途：通过唯一标识符 <code>id</code> 区分对象。</li>
</ul>
</li>
</ul>
<h4 id="5-6-2-示例应用"><a href="#5-6-2-示例应用" class="headerlink" title="5.6.2 示例应用"></a><strong>5.6.2 示例应用</strong></h4><ul>
<li>在内存游戏中，为卡片定义标识符：<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Card</span>: <span class="title class_ inherited__">Identifiable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> id: <span class="type">String</span> <span class="comment">// `id` 遵循 `Hashable` 协议</span></span><br><span class="line">    <span class="keyword">var</span> isFaceUp: <span class="type">Bool</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

    </div>

    
    
    
        <div class="reward-container">
  <div>欣赏此文？求鼓励，求支持！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="Serein 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpg" alt="Serein 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
      <div>
     
       
<div class="my_post_copyright">
  <div style="text-align:center;color: #ccc;font-size:14px;">------ 版权声明 ------</div>
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  
  <p><span>原始链接:</span><a href="/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/" title="Stanford cs193p 07｜Shape ViewModifier Constants">https://aricyq0.github.io/2025/01/05/Stanford-cs193p-07｜Shape-ViewModifier-Constants/</a>
    <button class="copy-button" style="cursor: pointer; margin-left: 6px; border: none; background: none;" title="点击复制文章链接">
      <i class="fa fa-clipboard" aria-label="复制"></i>
    </button>
    <span class="copy-success" style="margin-left: 5px; display: none; color: #999; font-size: 14px;">复制成功</span>
  </p>
  <p><span style="margin-right: 4px;">版权申明:</span>本博客所有文章除特别声明外，均采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="Attribution-NonCommercial-ShareAlike 4.0 International">CC BY-NC-SA 4.0</a>许可协议。转载请保留原文链接及作者。</p>  
</div>
<script> 
  document.addEventListener('DOMContentLoaded', function() {
    var clipboard = new ClipboardJS('.copy-button', {
      text: function() {
        return window.location.origin + '/2025/01/05/Stanford-cs193p-07%EF%BD%9CShape-ViewModifier-Constants/';
      }
    });
    
    clipboard.on('success', function(e) {
      var successTip = document.querySelector('.copy-success');
      successTip.style.display = 'inline';
      setTimeout(function() {
        successTip.style.display = 'none';
      }, 1000);
    });
  });
</script>

     
</div>
          
          <div class="post-tags">
              <a href="/tags/cs193p/" rel="tag"><i class="fa fa-tag"></i> cs193p</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/12/31/Stanford-cs193p-06-Layout-ViewBuilder/" rel="prev" title="Stanford cs193p 06 | Layout @ViewBuilder">
      <i class="fa fa-chevron-left"></i> Stanford cs193p 06 | Layout @ViewBuilder
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/01/20/Stanford-cs193p-08%EF%BD%9CAnimation/" rel="next" title="Stanford-cs193p-08｜Animation">
      Stanford-cs193p-08｜Animation <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0-%E5%BC%95%E8%A8%80"><span class="nav-text">0. 引言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%BC%94%E7%A4%BA%E6%8F%92%E6%9B%B2"><span class="nav-text">2. 演示插曲</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E5%88%86%E7%A6%BB%E8%A7%86%E5%9B%BE"><span class="nav-text">2.1 分离视图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-typealias"><span class="nav-text">2.1.1 typealias</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E5%A4%84%E7%90%86%E5%B8%B8%E9%87%8F"><span class="nav-text">2.2 处理常量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%9B%BE%E5%BD%A2%EF%BC%88Shape%EF%BC%89"><span class="nav-text">2. 图形（Shape）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E7%BB%98%E5%88%B6%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9B%BE%E5%BD%A2"><span class="nav-text">2.1 绘制自定义图形</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-1-Shape-%E5%8D%8F%E8%AE%AE%E7%9A%84%E9%BB%98%E8%AE%A4%E8%A1%8C%E4%B8%BA%EF%BC%9A"><span class="nav-text">2.1.1 Shape 协议的默认行为：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-%E5%AE%9E%E7%8E%B0-Shape-%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="nav-text">2.1.2 实现 Shape 协议的方法：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Demo-%E7%A4%BA%E4%BE%8B%EF%BC%9A%E7%BB%98%E5%88%B6%E4%B8%80%E4%B8%AA%E6%9C%AA%E5%8A%A8%E7%94%BB%E5%8C%96%E7%9A%84%E2%80%9C%E5%80%92%E8%AE%A1%E6%97%B6%E9%A5%BC%E5%9B%BE%E2%80%9D"><span class="nav-text">2.2 Demo 示例：绘制一个未动画化的“倒计时饼图”</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA-Pie%EF%BC%88shape%EF%BC%89"><span class="nav-text">2.2.1 创建一个 Pie（shape）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%8A%A8%E7%94%BB%EF%BC%88Animation%EF%BC%89"><span class="nav-text">3. 动画（Animation）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E5%8A%A8%E7%94%BB%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">3.1 动画的工作原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%8A%A8%E7%94%BB%E5%8C%96-Shape"><span class="nav-text">3.2 示例：动画化 Shape</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E8%A7%86%E5%9B%BE%E4%BF%AE%E9%A5%B0%E7%AC%A6%EF%BC%88ViewModifier%EF%BC%89"><span class="nav-text">4. 视图修饰符（ViewModifier）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E4%BB%80%E4%B9%88%E6%98%AF-ViewModifier%EF%BC%9F"><span class="nav-text">4.1 什么是 ViewModifier？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89-ViewModifier"><span class="nav-text">4.2 创建自定义 ViewModifier</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-Demo%EF%BC%9A%EF%BC%9A%E5%AE%9E%E7%8E%B0-Cardify-%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="nav-text">4.3 Demo：：实现 Cardify 修饰符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E5%8D%8F%E8%AE%AE%EF%BC%88Protocol%EF%BC%89"><span class="nav-text">5. 协议（Protocol）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%94%A8%E9%80%94"><span class="nav-text">5.1 协议的用途</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-1-%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%A0%B8%E5%BF%83%E4%BD%9C%E7%94%A8"><span class="nav-text">5.1.1 协议的核心作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-2-%E5%8D%8F%E8%AE%AE%E6%89%A9%E5%B1%95%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="nav-text">5.1.2 协议扩展的例子</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-2-1-%E7%A4%BA%E4%BE%8B-1%EF%BC%9A%E5%9C%A8%E5%8D%8F%E8%AE%AE%E4%B8%AD%E6%B7%BB%E5%8A%A0%E4%BF%AE%E9%A5%B0%E7%AC%A6%E5%8A%9F%E8%83%BD"><span class="nav-text">5.1.2.1 示例 1：在协议中添加修饰符功能</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-2-2-%E7%A4%BA%E4%BE%8B-2%EF%BC%9Afilter-%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text">5.1.2.2 示例 2：filter 的实现</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%E6%B3%9B%E5%9E%8B%E4%B8%8E%E5%8D%8F%E8%AE%AE"><span class="nav-text">5.2 泛型与协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-%E5%8D%8F%E8%AE%AE%E4%B8%AD%E7%9A%84%E6%B3%9B%E5%9E%8B%E7%B1%BB%E5%9E%8B"><span class="nav-text">5.2.1 协议中的泛型类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-2-%E4%BD%BF%E7%94%A8%E6%B3%9B%E5%9E%8B%E7%BA%A6%E6%9D%9F"><span class="nav-text">5.2.2 使用泛型约束</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-View-%E5%8D%8F%E8%AE%AE%E4%B8%8E-SwiftUI-%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F"><span class="nav-text">5.3 View 协议与 SwiftUI 类型系统</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-1-View-%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%BB%93%E6%9E%84"><span class="nav-text">5.3.1 View 协议的结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-2-%E6%89%A9%E5%B1%95-View-%E5%8D%8F%E8%AE%AE"><span class="nav-text">5.3.2 扩展 View 协议</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-4-some-%E5%92%8C-any-%E7%9A%84%E7%94%A8%E6%B3%95"><span class="nav-text">5.4 some 和 any 的用法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-4-1-some-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-text">5.4.1 some 关键字</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-4-2-%E4%BD%BF%E7%94%A8-some-%E5%88%9B%E5%BB%BA%E5%87%BD%E6%95%B0%E7%A4%BA%E4%BE%8B"><span class="nav-text">5.4.2 使用 some 创建函数示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-4-3-any-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-text">5.4.3 any 关键字</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-6-Identifiable-%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="nav-text">5.6 Identifiable 协议的例子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-6-1-%E5%8D%8F%E8%AE%AE%E5%AE%9A%E4%B9%89"><span class="nav-text">5.6.1 协议定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-6-2-%E7%A4%BA%E4%BE%8B%E5%BA%94%E7%94%A8"><span class="nav-text">5.6.2 示例应用</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Serein"
      src="/uploads/avatar.JPEG">
  <p class="site-author-name" itemprop="name">Serein</p>
  <div class="site-description" itemprop="description">Crazy learning, crazy sharing.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Aricyq0" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Aricyq0" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ari.cyq@gmail.com" title="E-Mail → mailto:ari.cyq@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2024 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Serein</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">122k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">1:51</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
